jQuery.loadImage=function(e){var n=function(n){function t(){i(),n.resolve(a)}function r(){i(),n.reject(a)}function i(){a.onload=null,a.onerror=null,a.onabort=null}var a=new Image;a.onload=t,a.onerror=r,a.onabort=r,a.src=e};return jQuery.Deferred(n).promise()},jQuery(function(){function e(){for(var e=p.find("a"),n=0;o+u>n;n++)for(var t=n,r=0;u>r&&!(r*o>t);r++)!function(t){setTimeout(function(){e.eq(t).addClass("show")},50*n)}(t),t+=o-1}function n(){for(var e=p.find("a"),n=0;o+u>n;n++)for(var t=d-n,r=u-1;r>=0&&!(t>(r+1)*o-1);r--)!function(t){setTimeout(function(){e.eq(t).addClass("show")},50*n)}(t),t-=o-1}function t(){return 0==l?d-1:r()+d-1>data.length-1?d-1:d-2}function r(e){return void 0===e&&(e=l),0==e?0:(d-2)*e+1}function i(){return data.length>r(l+1)}function a(){return l>0}var o,u,l=0,d=100,s=150,h=s,g=s;data=[];var c=jQuery(window),f=jQuery(".template-gallery-loading"),p=jQuery(".template-gallery");response=jQuery.parseJSON(gallery_images),data=response.data,p.trigger("data-ready"),p.on("data-ready window-resized page-turned",function(o,u){var l=[],d=[];p.trigger("loading");var s=data.slice(r(),r()+t());return jQuery.each(s,function(){d.push(jQuery.loadImage(this.thumb)),l.push('<a href="'+this.large+'" class="swipebox"'+'style="width:'+h+"px;height:"+g+"px;background-image:url("+this.thumb+')">'+"</a>")}),a()&&l.unshift('<a class="prev" style="width:'+h+"px;height:"+g+'px;"></a>'),i()&&l.push('<a class="next" style="width:'+h+"px;height:"+g+'px;"></a>'),l.length?(jQuery.when.apply(jQuery,d).always(function(){"window-resized"==o.type?(p.html(l.join("")),e(),jQuery(".template-gallery .swipebox").swipebox()):p.fadeOut(function(){p.html(l.join("")),"page-turned"==o.type&&"br"==u?n():e(),jQuery(".template-gallery .swipebox").swipebox(),p.show()}),p.trigger("loading-finished")}),void 0):!1}),p.on("loading",function(){f.show()}),p.on("loading-finished",function(){f.hide()}),p.on("click",".next",function(){l++,p.trigger("page-turned",["br"])}),p.on("click",".prev",function(){l--,p.trigger("page-turned",["tl"])}),c.on("resize",function(){var e,n,t,r=c.width(),i=c.height();i=jQuery(".template-gallery").height(),o=Math.ceil(r/s),t=(o*s-r)/o,h=Math.ceil(s-t),e=o*h,u=Math.ceil(i/s),t=(u*s-i)/u,g=Math.ceil(s-t),n=u*g,d=o*u,p.width(e).height(n),p.trigger("window-resized")}).resize()});